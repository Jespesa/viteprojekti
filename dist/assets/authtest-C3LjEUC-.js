import"./style-CE2F9O3O.js";import{f as u}from"./fetch-DtqXA3eh.js";console.log("Moi luodaan nyt tokeneita ja kirjaudutaan sisÃ¤Ã¤n");const m=async s=>{s.preventDefault();const t=document.querySelector(".registerForm"),r=t.querySelector("#username").value.trim(),i=t.querySelector("#password").value.trim(),n=t.querySelector("#email").value.trim(),o={username:r,password:i,email:n},l="http://localhost:3000/api/users",e={body:JSON.stringify(o),method:"POST",headers:{"Content-type":"application/json"}};console.log(e);const a=await u(l,e);if(a.error){console.error("Error adding a new user:",a.error);return}a.message&&console.log(a.message,"success"),console.log(a),t.reset()},p=async s=>{s.preventDefault();const t=document.querySelector(".loginForm"),r=t.querySelector("input[name=username]").value.trim(),i=t.querySelector("input[name=password]").value.trim(),n={username:r,password:i},o="http://localhost:3000/api/auth/login",l={body:JSON.stringify(n),method:"POST",headers:{"Content-type":"application/json"}};console.log("ðŸ”¹ LÃ¤hetetÃ¤Ã¤n kirjautumispyyntÃ¶:",l);const e=await u(o,l);if(e.error){console.error("â›” Kirjautumisvirhe:",e.error),alert("Kirjautuminen epÃ¤onnistui! Tarkista kÃ¤yttÃ¤jÃ¤tunnus ja salasana.");return}if(!e.token||!e.user){console.error("â›” Backend ei palauttanut tarvittavia tietoja:",e),alert("Kirjautuminen epÃ¤onnistui! Palvelinvirhe.");return}console.log("âœ… Kirjautuminen onnistui:",e),localStorage.setItem("token",e.token),localStorage.setItem("nimi",e.user.username),alert("Kirjautuminen onnistui, siirrÃ¤n sinut pÃ¤Ã¤sivulle!"),setTimeout(()=>{location.href="./apitest.html"},500)},d=async s=>{s.preventDefault();const t="http://localhost:3000/api/auth/me";let r={};r={Authorization:`Bearer ${localStorage.getItem("token")}`};const n={headers:r};console.log(n);const o=await u(t,n);if(o.error){console.error("Error adding a new user:",o.error);return}o.message&&console.log(o.message,"success"),console.log(o),c.reset()},g=document.querySelector(".registerForm");g.addEventListener("submit",m);const c=document.querySelector(".loginForm");c.addEventListener("submit",p);const y=document.querySelector("#meRequest");y.addEventListener("click",d);
